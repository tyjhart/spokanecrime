---
title: "National Arrests (1995-2016)"
output:
  html_document:
    df_print: paged
  html_notebook: default
  pdf_document: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r setup, echo = FALSE, include = FALSE}
library(readr)
library(tidyverse)
library(knitr)
knitr::opts_chunk$set(
  echo = TRUE, 
  message = FALSE,
  fig.pos = 'h',
  fig.align = 'center',
  collapse = TRUE,
  results = 'asis',
  dpi = 400,
  fig.path='./figures/',
  dev=c('pdf', 'png')
  )

source("recession_dates.R")
```

Import national arrest data from the CSV file into a data frame:

```{r data_import}
# Import CSV
df.arrests <- read_csv(
  "national_arrests_1995_2016.csv", 
  col_types = cols(year = col_date(format = "%Y"))
  )
```

Convert the new data frame from wide to long format, then factorize the crime names:

```{r data_wrangle}
# Prune columns and gather() to long format
df.arrests <- df.arrests %>% 
  select(year,homicide:curfew_loitering) %>%
  gather(
  "crime",
  "arrests",
  homicide:curfew_loitering
)

# Factorize crimes
df.arrests$crime <- as.factor(df.arrests$crime)
```

So-called "white collar" crimes, including embezzlement, fraud, and forgery:

```{r white_collar_crime}
df.arrests %>%
  filter(crime %in% c("embezzlement", "forgery", "fraud")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(aes(color = crime), size = 2) +
  geom_line(aes(color = crime)) +
  ggtitle("Embezzlement, Fraud, and Forgery") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")

df.arrests %>%
  filter(crime %in% c("embezzlement")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("Embezzlement") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")

df.arrests %>%
  filter(crime %in% c("forgery")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("Forgery") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")

df.arrests %>%
  filter(crime %in% c("fraud")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("Fraud") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")
```

Property and violent crimes:

```{r property_violent_crimes}
df.arrests %>%
  filter(crime %in% c("property_crime")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("Property Crimes") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")

df.arrests %>%
  filter(crime %in% c("violent_crime")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("Violent Crimes") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")
```

Larceny, motor vehicle theft, rape, and other specific crimes:

```{r general_crime_plots}
df.arrests %>%
  filter(crime %in% c("larceny")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  #geom_vline(xintercept=c(recession_dates$recession_start, recession_dates$recession_end), linetype=4) +
  ggtitle("Larceny") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")

df.arrests %>%
  filter(crime %in% c("motor_vehicle_theft")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("Motor Vehicle Thefts") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")

df.arrests %>%
  filter(crime %in% c("rape")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("Rape") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")

df.arrests %>%
  filter(crime %in% c("weapons")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("Weapons") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")

df.arrests %>%
  filter(crime %in% c("vagrancy")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("Vagrancy") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")
```

Alcohol-related crimes:

```{r alcohol_related}
df.arrests %>%
  filter(crime %in% c("dui")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("DUI") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")

df.arrests %>%
  filter(crime %in% c("drunkenness")) %>%
  ggplot(aes(year, arrests)) +
  geom_point(size = 2) +
  geom_line() +
  ggtitle("Drunkenness") +
  scale_y_continuous(name="Arrests", labels = scales::comma) +
  xlab("")
```
